# @configure_input@

CFLAGS += @CFLAGS@
# make dependencies files
CFLAGS += -MD -MP 
CC=@CC@
#AR=@AR@
AR=ar
RANLIB=@RANLIB@

EXESUFFIX=@EXEEXT@

TARGET=libhosted.a


all: $(TARGET)

clean:
	-rm -rf *.[doa] *.bak depend $(CLEAN_FILES) d/*.d *.d


clean-all: clean
	-rm -r autom4te.cache config.h config.log config.status configure 
#	-rm Makefile 


SRCDIRS = .
CFLAGS += -m32 -idirafter ../../include -idirafter ../../include/ia32 -DARCH_ia32
#CFLAGS += -I../../include -I../../include/ia32 -DARCH_ia32
#CFLAGS +=  -I../../include/ia32 -DARCH_ia32

FILES := $(foreach DIR,$(SRCDIRS),$(wildcard $(DIR)/*))
CFILES := $(filter %.c,$(FILES))
SFILES := $(filter %.S,$(FILES))
OBJFILES += $(patsubst %.c,%.o,$(notdir $(CFILES)))
OBJFILES += $(patsubst %.S,%.o,$(notdir $(SFILES)))

$(TARGET): $(filter-out $(EXCLUDED_OBJFILES), $(OBJFILES) )
	$(AR) $(ARFLAGS)  $@ $?
	cp $@ ../lib
	-@mkdir -p d
	-@mv *.d d



-include *.d
-include d/*.d
